<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PvPGN Status</title>
  <style>
    body { font-family: sans-serif; background:#111; color:#eee; padding:20px; }
    .cards { display:flex; flex-wrap:wrap; gap:12px; }
    .card {
      background:#222; padding:12px 16px; border-radius:6px;
      min-width:140px; text-align:center;
    }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { padding:8px; border-bottom:1px solid #333; }
    th { background:#222; }
  </style>
</head>
<body>

<h2>Server Statistics</h2>
<div class="cards">
  <div class="card">Users: <span id="users">?</span></div>
  <div class="card">Channels: <span id="channels">?</span></div>
  <div class="card">Active Games: <span id="games">?</span></div>
  <div class="card">Logins: <span id="logins">?</span></div>
  <div class="card">Uptime (s): <span id="uptime">?</span></div>
</div>

<h2>Active Games</h2>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Owner</th>
      <th>Players</th>
      <th>Type</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody id="games-table">
  </tbody>
</table>

<script>
async function loadGames() {
    const response = await fetch('/webportal/data/gameinfo.json');
    const data = await response.json(); // JSON is an array

    const tbody = document.querySelector('#games-table tbody');
    tbody.innerHTML = '';

    data.forEach(game => {
        let players = 0;
        if (Array.isArray(game.players)) {
            players = game.players.length;
        }

        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${game.game_name || '-'}</td>
            <td>${game.owner || '-'}</td>
            <td>${players}</td>
            <td>${game.type || '-'}</td>
            <td>${game.status || '-'}</td>
        `;
        tbody.appendChild(tr);
    });
}
loadGames();
</script>
</body>
</html>
